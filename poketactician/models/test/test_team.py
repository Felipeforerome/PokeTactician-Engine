import json
from unittest.mock import Mock

import numpy as np
import pytest

from poketactician.models.Pokemon import Pokemon
from poketactician.models.Team import Team


@pytest.fixture
def pokemons_list_fixture() -> list[Pokemon]:
    pokemon_data = [
        '{"id": 268, "name": "cascoon", "hp": 50, "att": 35, "deff": 55, "spatt": 25, "spdeff": 25, "spe": 15, "type1": "bug", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "450", "name": "bug-bite", "type": "bug", "damage_class": "physical", "power": 60, "accuracy": 1.0, "pp": 20, "priority": 0}, {"id": "527", "name": "electroweb", "type": "electric", "damage_class": "special", "power": 55, "accuracy": 0.95, "pp": 15, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 1, "Sapphire": 1, "FireRed": 0, "LeafGreen": 0, "Emerald": 1, "Colosseum": 0, "XD": 0, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 0, "Moon": 0, "Ultra Sun": 0, "Ultra Moon": 0, "Let\'s Go, Pikachu!": 0, "Let\'s Go, Eevee!": 0, "Sword": 0, "Shield": 0, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 0, "Violet": 0}}',
        '{"id": 25, "name": "pikachu", "hp": 35, "att": 55, "deff": 40, "spatt": 50, "spdeff": 50, "spe": 90, "type1": "electric", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "77", "name": "thunderbolt", "type": "electric", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "754", "name": "quick attack", "type": "normal", "damage_class": "physical", "power": 40, "accuracy": 1.0, "pp": 30, "priority": 1}, {"id": "870", "name": "iron tail", "type": "steel", "damage_class": "physical", "power": 100, "accuracy": 0.75, "pp": 15, "priority": 0}, {"id": "482", "name": "volt tackle", "type": "electric", "damage_class": "physical", "power": 120, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "871", "name": "brick break", "type": "fighting", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "566", "name": "signal beam", "type": "bug", "damage_class": "special", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "678", "name": "thunder", "type": "electric", "damage_class": "special", "power": 110, "accuracy": 0.7, "pp": 10, "priority": 0}, {"id": "763", "name": "foul play", "type": "dark", "damage_class": "physical", "power": 95, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "279", "name": "hidden power", "type": "ice", "damage_class": "special", "power": 60, "accuracy": 1.0, "pp": 15, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 6, "name": "charizard", "hp": 78, "att": 84, "deff": 78, "spatt": 109, "spdeff": 85, "spe": 100, "type1": "fire", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "52", "name": "flamethrower", "type": "fire", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "606", "name": "slash", "type": "normal", "damage_class": "physical", "power": 70, "accuracy": 1.0, "pp": 20, "priority": 0}, {"id": "566", "name": "dragon claw", "type": "dragon", "damage_class": "physical", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "60", "name": "fire spin", "type": "fire", "damage_class": "special", "power": 35, "accuracy": 0.85, "pp": 15, "priority": 0}, {"id": "441", "name": "air slash", "type": "flying", "damage_class": "special", "power": 75, "accuracy": 0.95, "pp": 15, "priority": 0}, {"id": "998", "name": "focus blast", "type": "fighting", "damage_class": "special", "power": 120, "accuracy": 0.7, "pp": 5, "priority": 0}, {"id": "297", "name": "thunder punch", "type": "electric", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "572", "name": "shadow claw", "type": "ghost", "damage_class": "physical", "power": 70, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "437", "name": "earthquake", "type": "ground", "damage_class": "physical", "power": 100, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "885", "name": "hidden power", "type": "ice", "damage_class": "special", "power": 60, "accuracy": 1.0, "pp": 15, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 282, "name": "gardevoir", "hp": 68, "att": 65, "deff": 65, "spatt": 125, "spdeff": 115, "spe": 80, "type1": "psychic", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "265", "name": "psychic", "type": "psychic", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "833", "name": "moonblast", "type": "fairy", "damage_class": "special", "power": 95, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "604", "name": "shadow ball", "type": "ghost", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "250", "name": "thunderbolt", "type": "electric", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "470", "name": "energy ball", "type": "grass", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "63", "name": "focus blast", "type": "fighting", "damage_class": "special", "power": 120, "accuracy": 0.7, "pp": 5, "priority": 0}, {"id": "169", "name": "magical leaf", "type": "grass", "damage_class": "special", "power": 60, "accuracy": 0.0, "pp": 20, "priority": 0}, {"id": "72", "name": "fire punch", "type": "fire", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "998", "name": "foul play", "type": "dark", "damage_class": "physical", "power": 95, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "617", "name": "surf", "type": "water", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 445, "name": "garchomp", "hp": 108, "att": 130, "deff": 95, "spatt": 80, "spdeff": 85, "spe": 102, "type1": "dragon", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "389", "name": "dragon claw", "type": "dragon", "damage_class": "physical", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "290", "name": "earthquake", "type": "ground", "damage_class": "physical", "power": 100, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "691", "name": "stone edge", "type": "rock", "damage_class": "physical", "power": 100, "accuracy": 0.8, "pp": 5, "priority": 0}, {"id": "425", "name": "aqua tail", "type": "water", "damage_class": "physical", "power": 90, "accuracy": 0.9, "pp": 10, "priority": 0}, {"id": "243", "name": "flamethrower", "type": "fire", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "398", "name": "poison jab", "type": "poison", "damage_class": "physical", "power": 80, "accuracy": 1.0, "pp": 20, "priority": 0}, {"id": "168", "name": "dragon rush", "type": "dragon", "damage_class": "physical", "power": 100, "accuracy": 0.75, "pp": 10, "priority": 0}, {"id": "284", "name": "fire fang", "type": "fire", "damage_class": "physical", "power": 65, "accuracy": 0.95, "pp": 15, "priority": 0}, {"id": "186", "name": "shadow claw", "type": "ghost", "damage_class": "physical", "power": 70, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "765", "name": "iron tail", "type": "steel", "damage_class": "physical", "power": 100, "accuracy": 0.75, "pp": 15, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 0, "Sapphire": 0, "FireRed": 0, "LeafGreen": 0, "Emerald": 0, "Colosseum": 0, "XD": 0, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 376, "name": "metagross", "hp": 80, "att": 135, "deff": 130, "spatt": 95, "spdeff": 90, "spe": 70, "type1": "steel", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "617", "name": "meteor mash", "type": "steel", "damage_class": "physical", "power": 90, "accuracy": 0.9, "pp": 10, "priority": 0}, {"id": "762", "name": "psychic", "type": "psychic", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "914", "name": "earthquake", "type": "ground", "damage_class": "physical", "power": 100, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "482", "name": "zen headbutt", "type": "psychic", "damage_class": "physical", "power": 80, "accuracy": 0.9, "pp": 15, "priority": 0}, {"id": "403", "name": "bullet punch", "type": "steel", "damage_class": "physical", "power": 40, "accuracy": 1.0, "pp": 30, "priority": 1}, {"id": "826", "name": "ice punch", "type": "ice", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "28", "name": "hammer arm", "type": "fighting", "damage_class": "physical", "power": 100, "accuracy": 0.9, "pp": 10, "priority": 0}, {"id": "806", "name": "shadow ball", "type": "ghost", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "246", "name": "hyper beam", "type": "normal", "damage_class": "special", "power": 150, "accuracy": 0.9, "pp": 5, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 384, "name": "rayquaza", "hp": 105, "att": 150, "deff": 90, "spatt": 150, "spdeff": 90, "spe": 95, "type1": "flying", "type2": null, "mythical": false, "legendary": true, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "224", "name": "dragon ascent", "type": "flying", "damage_class": "physical", "power": 120, "accuracy": 1.0, "pp": 5, "priority": 0}, {"id": "161", "name": "extreme speed", "type": "normal", "damage_class": "physical", "power": 80, "accuracy": 1.0, "pp": 5, "priority": 2}, {"id": "749", "name": "draco meteor", "type": "dragon", "damage_class": "special", "power": 130, "accuracy": 0.9, "pp": 5, "priority": 0}, {"id": "589", "name": "earthquake", "type": "ground", "damage_class": "physical", "power": 100, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "587", "name": "hyper voice", "type": "normal", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "301", "name": "aerial ace", "type": "flying", "damage_class": "physical", "power": 60, "accuracy": 0.0, "pp": 20, "priority": 0}, {"id": "909", "name": "surf", "type": "water", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "547", "name": "rock slide", "type": "rock", "damage_class": "physical", "power": 75, "accuracy": 0.9, "pp": 10, "priority": 0}, {"id": "37", "name": "fire blast", "type": "fire", "damage_class": "special", "power": 110, "accuracy": 0.85, "pp": 5, "priority": 0}, {"id": "967", "name": "focus blast", "type": "fighting", "damage_class": "special", "power": 120, "accuracy": 0.7, "pp": 5, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 448, "name": "lucario", "hp": 70, "att": 110, "deff": 70, "spatt": 115, "spdeff": 70, "spe": 90, "type1": "fighting", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "550", "name": "close combat", "type": "fighting", "damage_class": "physical", "power": 120, "accuracy": 1.0, "pp": 5, "priority": 0}, {"id": "200", "name": "dragon pulse", "type": "dragon", "damage_class": "special", "power": 85, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "487", "name": "extreme speed", "type": "normal", "damage_class": "physical", "power": 80, "accuracy": 1.0, "pp": 5, "priority": 2}, {"id": "41", "name": "iron tail", "type": "steel", "damage_class": "physical", "power": 100, "accuracy": 0.75, "pp": 15, "priority": 0}, {"id": "135", "name": "shadow ball", "type": "ghost", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "251", "name": "earthquake", "type": "ground", "damage_class": "physical", "power": 100, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "50", "name": "ice punch", "type": "ice", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "960", "name": "thunder punch", "type": "electric", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "262", "name": "dark pulse", "type": "dark", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "452", "name": "water pulse", "type": "water", "damage_class": "special", "power": 60, "accuracy": 1.0, "pp": 20, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 0, "Sapphire": 0, "FireRed": 0, "LeafGreen": 0, "Emerald": 0, "Colosseum": 0, "XD": 0, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 131, "name": "lapras", "hp": 130, "att": 85, "deff": 80, "spatt": 85, "spdeff": 95, "spe": 60, "type1": "ice", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "259", "name": "ice beam", "type": "ice", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "828", "name": "surf", "type": "water", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "483", "name": "body slam", "type": "normal", "damage_class": "physical", "power": 85, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "922", "name": "hydro pump", "type": "water", "damage_class": "special", "power": 110, "accuracy": 0.8, "pp": 5, "priority": 0}, {"id": "440", "name": "psychic", "type": "psychic", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "508", "name": "blizzard", "type": "ice", "damage_class": "special", "power": 110, "accuracy": 0.7, "pp": 5, "priority": 0}, {"id": "815", "name": "thunder", "type": "electric", "damage_class": "special", "power": 110, "accuracy": 0.7, "pp": 10, "priority": 0}, {"id": "42", "name": "solar beam", "type": "grass", "damage_class": "special", "power": 120, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "954", "name": "iron head", "type": "steel", "damage_class": "physical", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "162", "name": "dragon pulse", "type": "dragon", "damage_class": "special", "power": 85, "accuracy": 1.0, "pp": 10, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
        '{"id": 94, "name": "gengar", "hp": 60, "att": 65, "deff": 60, "spatt": 130, "spdeff": 75, "spe": 110, "type1": "ghost", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "knowable_moves": [{"id": "854", "name": "shadow ball", "type": "ghost", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "937", "name": "sludge bomb", "type": "poison", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "30", "name": "focus blast", "type": "fighting", "damage_class": "special", "power": 120, "accuracy": 0.7, "pp": 5, "priority": 0}, {"id": "887", "name": "thunderbolt", "type": "electric", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "331", "name": "dark pulse", "type": "dark", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "799", "name": "psychic", "type": "psychic", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "772", "name": "energy ball", "type": "grass", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "195", "name": "ice punch", "type": "ice", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "290", "name": "shadow punch", "type": "ghost", "damage_class": "physical", "power": 60, "accuracy": 0.0, "pp": 20, "priority": 0}, {"id": "899", "name": "dazzling gleam", "type": "fairy", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 10, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}',
    ]

    pokemon_dicts = [json.loads(data) for data in pokemon_data]
    pokemons_list = [Pokemon.from_json(pokemon_dict) for pokemon_dict in pokemon_dicts]
    return pokemons_list


def test_add_pokemon() -> None:
    """
    Test that adding a Pokemon to a team works as expected.

    Returns:
        None
    """
    team = Team()
    team.add_pokemon("pokemon")
    assert team.pokemons == ["pokemon"]


def test_ant_to_team(pokemons_list_fixture: list) -> None:
    """
    Test that converting an ant to a team works as expected.

    Args:
        team_fixture (Team): The Team instance to test.

    Returns:
        None
    """
    ant_list = [
        [9, 3, 4, 0, 6],
        [0, 1, -1, -1, -1],
        [5, 6, 4, 5, 3],
        [8, 1, 5, 3, 6],
        [9, 4, 5, 8, 0],
        [2, 7, 0, 4, 1],
    ]
    ant = np.array(ant_list)
    team = Team.ant_to_team(ant, pokemons_list_fixture)
    # Check each Pokémon and their moves
    for i, pok in enumerate(ant):
        # Get the Pokémon from the team and the expected Pokémon from the fixture
        team_pokemon = team.pokemons[i]
        expected_pokemon = pokemons_list_fixture[pok[0]]

        # Check if the Pokémon is the correct one
        assert (
            team_pokemon.id == expected_pokemon.id
        ), f"Expected Pokémon ID {expected_pokemon.id}, but got {team_pokemon.id}."
        assert (
            team_pokemon.name == expected_pokemon.name
        ), f"Expected Pokémon name {expected_pokemon.name}, but got {team_pokemon.name}."

        # Check the moves
        taught_moves = [move for move in pok[1:] if move != -1]
        assert len(team_pokemon.learnt_moves) == len(
            taught_moves
        ), f"Expected {len(taught_moves)} moves, but got {len(team_pokemon.learnt_moves)}."

        for move_index, expected_move_id in enumerate(taught_moves):
            expected_move = expected_pokemon.knowable_moves[expected_move_id]
            actual_move = team_pokemon.learnt_moves[move_index]

            assert (
                actual_move.id == expected_move.id
            ), f"Expected move ID {expected_move.id}, but got {actual_move.id}."
            assert (
                actual_move.name == expected_move.name
            ), f"Expected move name {expected_move.name}, but got {actual_move.name}."


@pytest.fixture
def team_fixture(pokemons_list_fixture: list[Pokemon]) -> Team:
    ant_list = [
        [9, 3, 4, 0, 6],
        [0, 1, -1, -1, -1],
        [5, 6, 4, 5, 3],
        [8, 1, 5, 3, 6],
        [9, 4, 5, 8, 0],
        [2, 7, 0, 4, 1],
    ]
    ant = np.array(ant_list)
    team = Team.ant_to_team(ant, pokemons_list_fixture)
    return team


def test_team_has_roles(team_fixture: Team) -> None:
    """
    Test that a team validates having roles correctly.

    Args:
        team_fixture (Team): The Team instance to test.

    Returns:
        None
    """

    mock_role_1 = Mock(return_value=True)
    mock_role_2 = Mock(return_value=True)
    mock_role_false = Mock(return_value=False)

    # Since one is false, the result should be false
    roles = [mock_role_1, mock_role_2, mock_role_false]
    result = team_fixture.team_has_roles(roles)
    assert result == False

    # Since all are true, the result should be true
    roles = [mock_role_1, mock_role_2]
    result = team_fixture.team_has_roles(roles)
    assert result == True


def test_serialize_team(
    team_fixture: Team, pokemons_list_fixture: list[Pokemon]
) -> None:
    """
    Test that the Team's serialize method returns the expected serialized data.

    Args:
        team_fixture (Team): The Team instance to test.
        pokemons_list_fixture (list): The list of Pokémon fixtures.

    Returns:
        None
    """
    expected_serialized_data = json.loads(
        '[{"id": 94, "name": "gengar", "hp": 60, "att": 65, "deff": 60, "spatt": 130, "spdeff": 75, "spe": 110, "type1": "ghost", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "moves": [{"id": "887", "name": "thunderbolt", "type": "electric", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "331", "name": "dark pulse", "type": "dark", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "854", "name": "shadow ball", "type": "ghost", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "772", "name": "energy ball", "type": "grass", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}, {"id": 268, "name": "cascoon", "hp": 50, "att": 35, "deff": 55, "spatt": 25, "spdeff": 25, "spe": 15, "type1": "bug", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "moves": [{"id": "527", "name": "electroweb", "type": "electric", "damage_class": "special", "power": 55, "accuracy": 0.95, "pp": 15, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 1, "Sapphire": 1, "FireRed": 0, "LeafGreen": 0, "Emerald": 1, "Colosseum": 0, "XD": 0, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 0, "Moon": 0, "Ultra Sun": 0, "Ultra Moon": 0, "Let\'s Go, Pikachu!": 0, "Let\'s Go, Eevee!": 0, "Sword": 0, "Shield": 0, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 0, "Violet": 0}}, {"id": 376, "name": "metagross", "hp": 80, "att": 135, "deff": 130, "spatt": 95, "spdeff": 90, "spe": 70, "type1": "steel", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "moves": [{"id": "28", "name": "hammer arm", "type": "fighting", "damage_class": "physical", "power": 100, "accuracy": 0.9, "pp": 10, "priority": 0}, {"id": "403", "name": "bullet punch", "type": "steel", "damage_class": "physical", "power": 40, "accuracy": 1.0, "pp": 30, "priority": 1}, {"id": "826", "name": "ice punch", "type": "ice", "damage_class": "physical", "power": 75, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "482", "name": "zen headbutt", "type": "psychic", "damage_class": "physical", "power": 80, "accuracy": 0.9, "pp": 15, "priority": 0}], "games": {"Red": 0, "Green": 0, "Blue": 0, "Yellow": 0, "Gold": 0, "Silver": 0, "Crystal": 0, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}, {"id": 131, "name": "lapras", "hp": 130, "att": 85, "deff": 80, "spatt": 85, "spdeff": 95, "spe": 60, "type1": "ice", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "moves": [{"id": "828", "name": "surf", "type": "water", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "508", "name": "blizzard", "type": "ice", "damage_class": "special", "power": 110, "accuracy": 0.7, "pp": 5, "priority": 0}, {"id": "922", "name": "hydro pump", "type": "water", "damage_class": "special", "power": 110, "accuracy": 0.8, "pp": 5, "priority": 0}, {"id": "815", "name": "thunder", "type": "electric", "damage_class": "special", "power": 110, "accuracy": 0.7, "pp": 10, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}, {"id": 94, "name": "gengar", "hp": 60, "att": 65, "deff": 60, "spatt": 130, "spdeff": 75, "spe": 110, "type1": "ghost", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "moves": [{"id": "331", "name": "dark pulse", "type": "dark", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "799", "name": "psychic", "type": "psychic", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 10, "priority": 0}, {"id": "290", "name": "shadow punch", "type": "ghost", "damage_class": "physical", "power": 60, "accuracy": 0.0, "pp": 20, "priority": 0}, {"id": "854", "name": "shadow ball", "type": "ghost", "damage_class": "special", "power": 80, "accuracy": 1.0, "pp": 15, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}, {"id": 6, "name": "charizard", "hp": 78, "att": 84, "deff": 78, "spatt": 109, "spdeff": 85, "spe": 100, "type1": "fire", "type2": null, "mythical": false, "legendary": false, "battleOnly": false, "mega": false, "moves": [{"id": "572", "name": "shadow claw", "type": "ghost", "damage_class": "physical", "power": 70, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "52", "name": "flamethrower", "type": "fire", "damage_class": "special", "power": 90, "accuracy": 1.0, "pp": 15, "priority": 0}, {"id": "441", "name": "air slash", "type": "flying", "damage_class": "special", "power": 75, "accuracy": 0.95, "pp": 15, "priority": 0}, {"id": "606", "name": "slash", "type": "normal", "damage_class": "physical", "power": 70, "accuracy": 1.0, "pp": 20, "priority": 0}], "games": {"Red": 1, "Green": 1, "Blue": 1, "Yellow": 1, "Gold": 1, "Silver": 1, "Crystal": 1, "Ruby": 1, "Sapphire": 1, "FireRed": 1, "LeafGreen": 1, "Emerald": 1, "Colosseum": 1, "XD": 1, "Diamond": 1, "Pearl": 1, "Platinum": 1, "HeartGold": 1, "SoulSilver": 1, "Black": 1, "White": 1, "Black 2": 1, "White 2": 1, "X": 1, "Y": 1, "Omega Ruby": 1, "Alpha Sapphire": 1, "Sun": 1, "Moon": 1, "Ultra Sun": 1, "Ultra Moon": 1, "Let\'s Go, Pikachu!": 1, "Let\'s Go, Eevee!": 1, "Sword": 1, "Shield": 1, "Brilliant Diamond": 1, "Shining Pearl": 1, "Legends: Arceus": 1, "Scarlet": 1, "Violet": 1}}]'
    )

    serialized_team = team_fixture.serialize()

    # Assert that the serialized team data matches the expected data
    assert (
        serialized_team == expected_serialized_data
    ), "The serialized team data does not match the expected data."
